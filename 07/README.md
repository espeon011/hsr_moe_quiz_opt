# 教育部の難問その 7

## 問題文

> 人目のつかない雪原の片隅に、古代の宝物が隠されているといわれています。
> 探検家~~サンポ~~青髪のイケメンは数々の苦労を乗り越え、ついにその宝が隠された秘密の場所を見つけました。
> そこには言葉を話す2つの扉がありました。
> 1つは金の扉、もう1つは銀の扉です。
> その2つの扉のうち、片方の扉は真実を話しますが、もう片方の扉は嘘しか言いません。
> 片方の扉の奥には財宝があり、もう片方の扉の奥には古代のモンスターがいます。
> 宝の地図によると、2つの扉は1つの質問にしか答えてくれません。
> 頭のいい~~サンポ~~青髪のイケメンはしばらく考えこんだ末に、銀の扉に向かって「金の扉はあなたの奥に何があると言いますか？」と聞きました。
> 銀の扉は「この後ろにあるのは財宝であると言うのだろう」と答えました。
> ~~サンポ~~青髪のイケメンはどちらの扉を開けるでしょうか？

## 解き方

金の扉が真実を話す場合, 銀の扉は嘘しか言わなくなる. 

- 銀の扉の後ろに財宝がある場合
	- 金の扉(真実)「銀の扉の後ろには財宝がある」
	- 銀の扉(嘘)「『この後ろには古代のモンスターがいる』と言うだろう」
- 銀の扉の後ろに古代のモンスターがいる場合
	- 金の扉(真実)「銀の扉の後ろには古代のモンスターがいる」
	- 銀の扉(嘘)「『この後ろには財宝がある』と言うだろう」

金の扉が嘘しか言わない場合, 銀の扉は真実を話すことになる. 

- 銀の扉の後ろに財宝がある場合
	- 金の扉(嘘)「銀の扉の後ろには古代のモンスターがいる」
	- 銀の扉(真実)「『この後ろには古代のモンスターがいる』と言うだろう」
- 銀の扉の後ろに古代のモンスターがいる場合
	- 金の扉(嘘)「銀の扉の後ろには財宝がある」
	- 銀の扉(真実)「『この後ろには財宝がある』と言うだろう」

銀の扉は金の扉が「後ろに財宝がある」と主張すると言っているので銀の扉の後ろには古代のモンスターがおり, 金の扉の後ろに財宝がある. 

一般に $A$ と $B$ のどちらか一方が正直者でどちらか一方が嘘つきである場合, Yes か No で回答する質問 $X$ に対して「$A$ は $X$ に Yes と回答するか? 」と $B$ に聞くと $X$ についての事実と逆の回答が返ってくる. (嘘つきの回答を丁度 1 回経由するため)

今回 $X$ は「銀の扉の後ろに財宝があるか」で, 回答は Yes であったため実際は No であり銀の扉の後ろに財宝はない. 

## 定式化

金の扉, 銀の扉をそれぞれ $1$, $2$ とする. 

### 決定変数

- $x_i \in \{0, 1\}$ (for $i = 1, 2$): $i$ は真実を話す
- $y_i \in \{0, 1\}$ (for $i = 1, 2$): $i$ は嘘を話す
- $v_i \in \{0, 1\}$ (for $i = 1, 2$): $i$ の後ろには財宝がある
- $w_i \in \{0, 1\}$ (for $i = 1, 2$): $i$ の後ろには古代のモンスターがいる
- $s \in \{0, 1\}$: 金の扉は銀の扉の後ろには財宝があると主張する
- $t \in \{0, 1\}$: 金の扉は銀の扉の後ろには古代のモンスターがいると主張する
- $p \in \{0, 1\}$: 銀の扉は「金の扉が銀の扉の後ろに財宝があると言う」と主張する
- $q \in \{0, 1\}$: 銀の扉は「金の扉が銀の扉の後ろにモンスターがいると言う」と主張する

### 制約条件

- $x_i + y_i = 1$ (for $i = 1, 2$): 真実を話すか嘘を話すかどちらか一方
- 下式: 片方は真実を話し, 片方は嘘を話す
$$\sum_{i=1}^2 x_i = 1 \quad \text{and} \quad \sum_{i=1}^2 y_i = 1$$
- $v_i + w_i = 1$ (for $i = 1, 2$): 扉の後ろには財宝かモンスターのどちらか一方がある
- 下式: 片方の後ろには財宝があり, 片方の後ろにはモンスターがいる
$$\sum_{i=1}^2 v_i = 1 \quad \text{and} \quad \sum_{i=1}^2 w_i = 1$$
- $s + t = 1$: 金の扉の主張はどちらか一方のみ
- $x_1 + v_2 \le 1 + s$: 金の扉が正直者で銀の扉の後ろに財宝があればそのように主張する
- $x_1 + w_2 \le 1 + t$: 金の扉が正直者で銀の扉の後ろにモンスターがいればそのように主張する
- $y_1 + v_2 \le 1 + t$: 金の扉が嘘つきで銀の扉の後ろに財宝があれば逆の主張する
- $y_1 + w_2 \le 1 + s$: 金の扉が嘘つきで銀の扉の後ろにモンスターがいれば逆の主張する
- $p + q = 1$: 銀の盾の主張はどちらか一方のみ
- $x_2 + s \le 1 + p$: 銀の扉が正直者であれば金の扉が「銀の扉の後ろには財宝がある」と言うであろうことをそのまま伝える
- $x_2 + t \le 1 + q$: 銀の扉が正直者であれば金の扉が「銀の扉の後ろにはモンスターがいる」と言うであろうことをそのまま伝える
- $y_2 + s \le 1 + q$: 銀の扉が嘘つきであれば金の扉が「銀の扉の後ろには財宝がある」と言うであろう場合逆のことを話す
- $y_2 + t \le 1 + p$: 銀の扉が嘘つきであれば金の扉が「銀の扉の後ろにはモンスターがいる」と言うであろう場合逆のことを話す
- $p = 1$: 銀の扉は「(金の扉は)この後ろにあるのは財宝であると言うのだろう」と答えた

### 実行結果

```shell
$ dotnet run -c Release
Solution #1: time = 0.00 s
  Gold   gate is a Liar   TREASURE
  Silver gate is a Honest
Solution #2: time = 0.01 s
  Gold   gate is a Honest TREASURE
  Silver gate is a Liar
Number of solutions found: 2
```
